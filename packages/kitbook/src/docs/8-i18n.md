# i18n

Kitbook can automatically display variants in each of your languages.

To get started, add an array of languages to your config, and a function so Kitbook knows how to add the language to the URL. If your i18n language can be chosen via URL, then you can use the following code:

```ts title="vite.config.ts" {5-9}
import { defineConfig } from 'kitbook/defineConfig'

export default defineConfig({
  // other config...
  languages: [
    { name: 'English', code: 'en', },
    { name: 'Spanish', code: 'es', },
  ],
  addLanguageToUrl: ({ code, url }) => url.replace('[lang]', code),
})
```

The above function would work if you happen to use a dynamic parameter in your route to define the language code (e.g. `/[lang]/foo`).

If you only select language based off browser settings and a cookie-stored value that you save when users change language, then you may need to update your i18n code to also listen to a query param like `lang=de` to set the language. Then you can use the following code to get the language from the URL:

```ts
const urlParams = new URLSearchParams(window.location.search)
locale = urlParams.get('lang')
```

And your `addLanguageToUrl` function would be:

```ts
function addLanguageToUrl({ code, url }) {
  const [path, search] = url.split('?')
  const params = new URLSearchParams(search)
  params.set('lang', code)
  return `${path}?${params.toString()}`
}
```

By default Kitbook only displays variants in your first language but the interface has controls to change the displayed language or show multiple languages at once.

## Visual Regression Testing

If you use [[7-visual-regression-testing]], screenshots will be automatically be created using all of your languages.

If you have a lot of languages you may benefit from [sharding](https://playwright.dev/docs/test-sharding) your tests across multiple machines. An example workflow will be posted here in the future on how to do this. If you don't know how to get started with sharding, you may need to settle for adjusting the workflow timeout length in the meantime.

Also consider turning off i18n where it's not needed as described next.

## Fine-grained language control

Just like viewports have [[3-component-variants#Fine-grained viewport control]], you can override project language defaults on a variant file basis or for an individual variant. For example, in a project with English, Spanish, and French, we could do the following to restrict down to just two or even one language:

```ts title="foo.variants.ts"
import type { Language, Variant } from 'kitbook'
import type Component from './EditInGithub.svelte'

export const languages: Language[] = [
  { code: 'en', name: 'English' },
  { code: 'es', name: 'Spanish' },
]

export const variants: Variant<Component>[] = [
  {
    name: 'English and Spanish',
  },
  {
    name: 'Just Spanish',
    languages: [{ code: 'es', name: 'Spanish' }],
  },
]
```

Some components may not have any translated strings and so it doesn't make sense to iterate across languages. In that case you can just export an empty languages array from the variants file to show the first active language:

```ts title="Foo.variants.ts"
export const languages = []
```

You can also set an individual variant's languages array to an empty array for the same effect on just that specific variant.

There is also an optional `languages` export from the composition file:

```svelte title="Foo.composition"
<script lang="ts" context="module">
  import type { Language } from 'kitbook'

  export const languages: Language[] = [
    { code: 'en', name: 'English' },
    { code: 'fr', name: 'French' },
  ]
</script>
``` 

Once again, an empty array is a quick way to just show the first active language.

---

You've now learned the features of Kitbook as far as they have been documented. As you document and prototype your components for each situation you need, you may run into questions as to how to accomplish something. Feel free to browse the Kitbook related files in any of the provided [[9-examples|repo examples]] where Kitbook in is use. You may find your answer there. If not, please [create an issue](https://github.com/jacob-8/kitbook/issues/new), and let's discuss how you could add a needed feature.


[//begin]: # "Autogenerated link references for markdown compatibility"
[7-visual-regression-testing]: 7-visual-regression-testing.md "Visual Regression Testing"
[3-component-variants#Fine-grained viewport control]: 3-component-variants.md "Component Variants"
[9-examples|repo examples]: 9-examples.md "Examples"
[//end]: # "Autogenerated link references"